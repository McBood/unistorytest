{"ast":null,"code":"import { useContext, useEffect, useMemo } from 'react';\nimport { MultiChainStatesContext } from '../providers';\nimport { utils } from 'ethers';\n/**\n * A low-level function that makes multiple calls to specific methods of specific contracts and returns values or error if present.\n * The hook will cause the component to refresh when values change.\n *\n * Calls will be combined into a single multicall across all uses of {@link useChainCall}, {@link useChainCalls}, {@link useRawCall} and {@link useRawCalls}.\n * It is recommended to use {@link useCalls} where applicable instead of this method.\n * @public\n * @param calls List of calls, also see {@link RawCall}. Calls need to be in the same order across component renders.\n * @returns list of multicall calls. See {@link RawCallResult} and {@link useRawCall}.\n */\nexport function useRawCalls(calls) {\n  const {\n    dispatchCalls,\n    chains\n  } = useContext(MultiChainStatesContext);\n  useEffect(() => {\n    const filteredCalls = calls.filter(Boolean);\n    dispatchCalls({\n      type: 'ADD_CALLS',\n      calls: filteredCalls\n    });\n    return () => dispatchCalls({\n      type: 'REMOVE_CALLS',\n      calls: filteredCalls\n    });\n  }, [JSON.stringify(calls), dispatchCalls]);\n  return useMemo(() => calls.map(call => {\n    return call ? extractCallResult(chains, call) : undefined;\n  }), [JSON.stringify(calls), chains]);\n}\n/**\n * A low-level function that makes a call to a specific method of a specific contract and returns the value or error if present.\n * The hook will cause the component to refresh whenever a new block is mined and the value is changed.\n *\n * Calls will be combined into a single multicall across all uses of {@link useChainCall}, {@link useChainCalls}, {@link useRawCall} and {@link useRawCalls}.\n * It is recommended to use {@link useCall} where applicable instead of this method.\n *\n * @param call a single call, also see {@link RawCall}.\n *             A call can be Falsy, as it is important to keep the same ordering of hooks even if in a given render cycle\n *             and there might be not enough information to perform a call.\n * @public\n * @returns result of multicall call.\n *   The hook returns {@link RawCallResult} type.\n *   That is: `undefined` when call didn't return yet or object `{ success: boolean, value: string }` if it did,\n *   `success` - boolean indicating whether call was successful or not,\n *   `value` - encoded result when success is `true` or encoded error message when success is `false`.\n */\nexport function useRawCall(call) {\n  return useRawCalls([call])[0];\n}\nfunction extractCallResult(chains, call) {\n  var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l, _m, _o, _p, _q;\n  const chainId = call.chainId;\n  if (chainId !== undefined) {\n    const rawCallResult = (_d = (_c = (_b = (_a = chains[chainId]) === null || _a === void 0 ? void 0 : _a.value) === null || _b === void 0 ? void 0 : _b.state) === null || _c === void 0 ? void 0 : _c[call.address.toLowerCase()]) === null || _d === void 0 ? void 0 : _d[call.data];\n    if (rawCallResult) {\n      return rawCallResult;\n    }\n    const error = (_f = (_e = chains[chainId]) === null || _e === void 0 ? void 0 : _e.value) === null || _f === void 0 ? void 0 : _f.error;\n    if (error) {\n      const defaultErrorMessage = 'An error occurred';\n      const errorMessage = (_q = (_p = (_m = (_l = (_j = (_h = (_g = error.error) === null || _g === void 0 ? void 0 : _g.data) === null || _h === void 0 ? void 0 : _h.message) !== null && _j !== void 0 ? _j : (_k = error.error) === null || _k === void 0 ? void 0 : _k.message) !== null && _l !== void 0 ? _l : error.reason) !== null && _m !== void 0 ? _m : (_o = error.data) === null || _o === void 0 ? void 0 : _o.message) !== null && _p !== void 0 ? _p : error.message) !== null && _q !== void 0 ? _q : defaultErrorMessage;\n      const value = new utils.Interface(['function Error(string)']).encodeFunctionData('Error', [errorMessage]);\n      return {\n        success: false,\n        value\n      };\n    }\n  }\n}","map":{"version":3,"names":["useContext","useEffect","useMemo","MultiChainStatesContext","utils","useRawCalls","calls","dispatchCalls","chains","filteredCalls","filter","Boolean","type","JSON","stringify","map","call","extractCallResult","undefined","useRawCall","chainId","rawCallResult","_d","_c","_b","_a","value","state","address","toLowerCase","data","error","_f","_e","defaultErrorMessage","errorMessage","_q","_p","_m","_l","_j","_h","_g","message","_k","reason","_o","Interface","encodeFunctionData","success"],"sources":["/Users/mcbood/Desktop/unitest/node_modules/@usedapp/core/src/hooks/useRawCalls.ts"],"sourcesContent":["import { useContext, useEffect, useMemo } from 'react'\nimport { MultiChainStatesContext, RawCallResult } from '../providers'\nimport { RawCall } from '../providers'\nimport { Falsy } from '../model/types'\nimport { MultiChainState } from '../providers/chainState/multiChainStates/context'\nimport { utils } from 'ethers'\n\n/**\n * A low-level function that makes multiple calls to specific methods of specific contracts and returns values or error if present.\n * The hook will cause the component to refresh when values change.\n *\n * Calls will be combined into a single multicall across all uses of {@link useChainCall}, {@link useChainCalls}, {@link useRawCall} and {@link useRawCalls}.\n * It is recommended to use {@link useCalls} where applicable instead of this method.\n * @public\n * @param calls List of calls, also see {@link RawCall}. Calls need to be in the same order across component renders.\n * @returns list of multicall calls. See {@link RawCallResult} and {@link useRawCall}.\n */\nexport function useRawCalls(calls: (RawCall | Falsy)[]): RawCallResult[] {\n  const { dispatchCalls, chains } = useContext(MultiChainStatesContext)\n\n  useEffect(() => {\n    const filteredCalls = calls.filter(Boolean) as RawCall[]\n    dispatchCalls({ type: 'ADD_CALLS', calls: filteredCalls })\n    return () => dispatchCalls({ type: 'REMOVE_CALLS', calls: filteredCalls })\n  }, [JSON.stringify(calls), dispatchCalls])\n\n  return useMemo(\n    () =>\n      calls.map((call) => {\n        return call ? extractCallResult(chains, call) : undefined\n      }),\n    [JSON.stringify(calls), chains]\n  )\n}\n\n/**\n * A low-level function that makes a call to a specific method of a specific contract and returns the value or error if present.\n * The hook will cause the component to refresh whenever a new block is mined and the value is changed.\n *\n * Calls will be combined into a single multicall across all uses of {@link useChainCall}, {@link useChainCalls}, {@link useRawCall} and {@link useRawCalls}.\n * It is recommended to use {@link useCall} where applicable instead of this method.\n *\n * @param call a single call, also see {@link RawCall}.\n *             A call can be Falsy, as it is important to keep the same ordering of hooks even if in a given render cycle\n *             and there might be not enough information to perform a call.\n * @public\n * @returns result of multicall call.\n *   The hook returns {@link RawCallResult} type.\n *   That is: `undefined` when call didn't return yet or object `{ success: boolean, value: string }` if it did,\n *   `success` - boolean indicating whether call was successful or not,\n *   `value` - encoded result when success is `true` or encoded error message when success is `false`.\n */\nexport function useRawCall(call: RawCall | Falsy) {\n  return useRawCalls([call])[0]\n}\n\nfunction extractCallResult(chains: MultiChainState, call: RawCall): RawCallResult {\n  const chainId = call.chainId\n  if (chainId !== undefined) {\n    const rawCallResult = chains[chainId]?.value?.state?.[call.address.toLowerCase()]?.[call.data]\n    if (rawCallResult) {\n      return rawCallResult\n    }\n    const error = chains[chainId]?.value?.error as any\n    if (error) {\n      const defaultErrorMessage = 'An error occurred'\n      const errorMessage =\n        error.error?.data?.message ??\n        error.error?.message ??\n        error.reason ??\n        error.data?.message ??\n        error.message ??\n        defaultErrorMessage\n      const value = new utils.Interface(['function Error(string)']).encodeFunctionData('Error', [errorMessage])\n      return {\n        success: false,\n        value,\n      }\n    }\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}